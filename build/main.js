!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function e(e,n,i,t){return new(i||(i=Promise))((function(o,r){function a(e){try{d(t.next(e))}catch(e){r(e)}}function l(e){try{d(t.throw(e))}catch(e){r(e)}}function d(e){var n;e.done?o(e.value):(n=e.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,l)}d((t=t.apply(e,n||[])).next())}))}function n(e,n){var i,t,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,t&&(o=2&r[0]?t.return:r[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,r[1])).done)return o;switch(t=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,t=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=n.call(e,a)}catch(e){r=[6,e],t=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}}function i(){var i;return e(this,void 0,void 0,(function(){var e,t,o,r;return n(this,(function(n){switch(n.label){case 0:return e=new Date,t=window.roamAlphaAPI.util.dateToPageTitle(e),o=window.roamAlphaAPI.util.dateToPageUid(e),[4,null===(i=window.roamAlphaAPI.q("\n  [:find [(pull ?e [:block/uid])] :in $ ?today-title :where [?e :node/title ?today-title]]\n  ",t))||void 0===i?void 0:i[0]];case 1:return(r=n.sent())?[3,3]:[4,window.roamAlphaAPI.data.page.create({page:{uid:o,title:t}})];case 2:return n.sent(),[3,4];case 3:o=r.uid,n.label=4;case 4:return[2,o]}}))}))}var t="Archived Notes",o="".concat(t,"::");function r(){var r,a;return e(this,void 0,void 0,(function(){var e,l;return n(this,(function(n){switch(n.label){case 0:return[4,i()];case 1:return e=n.sent(),[4,null===(a=null===(r=window.roamAlphaAPI.q("[:find ?attr-uid :in $ ?page-uid ?archived-notes-title\n      :where [?p :block/uid ?page-uid]\n             [?p :block/children ?c]\n             [?a :node/title ?archived-notes-title]\n             [?c :block/refs ?a]\n             [?c :block/uid ?attr-uid]]",e,t))||void 0===r?void 0:r[0])||void 0===a?void 0:a[0]];case 2:return(l=n.sent())?[3,5]:(l=window.roamAlphaAPI.util.generateUID(),[4,window.roamAlphaAPI.data.block.create({location:{"parent-uid":e,order:0},block:{string:o,uid:l,open:!1}})]);case 3:return n.sent(),[4,window.roamAlphaAPI.data.block.update({block:{uid:l,open:!1}})];case 4:n.sent(),n.label=5;case 5:return[2,l]}}))}))}function a(i,t){var o,a,l,d;return e(this,void 0,void 0,(function(){var e,i,c,u;return n(this,(function(n){switch(n.label){case 0:return[4,r()];case 1:return e=n.sent(),[4,null===(a=null===(o=window.roamAlphaAPI.q("[:find (pull ?e [:block/uid :node/title]) :in $ ?child-uid :where [?c :block/uid ?child-uid] [?c :block/parents ?e] [?e :block/children ?c]]",t))||void 0===o?void 0:o[0])||void 0===a?void 0:a[0]];case 2:return i=n.sent(),c=(null==i?void 0:i.title)?"[[".concat(i.title,"]]"):"((".concat(i.uid,"))"),[4,null===(d=null===(l=window.roamAlphaAPI.q("[:find ?uid :in $ ?archived-attr-uid ?ref-uid :where [?a :block/uid ?archived-attr-uid] [?a :block/children ?c] [?r :block/uid ?ref-uid] [?c :block/refs ?r] [?c :block/uid ?uid]]",e,i.uid))||void 0===l?void 0:l[0])||void 0===d?void 0:d[0]];case 3:return(u=n.sent())?[3,5]:(u=window.roamAlphaAPI.util.generateUID(),[4,window.roamAlphaAPI.data.block.create({location:{"parent-uid":e,order:0},block:{uid:u,string:c}})]);case 4:n.sent(),n.label=5;case 5:return[4,window.roamAlphaAPI.data.block.move({location:{"parent-uid":u,order:-1},block:{uid:t}})];case 6:return n.sent(),[2]}}))}))}function l(i,t){return e(this,void 0,void 0,(function(){var e,i,o,r,a;return n(this,(function(n){switch(n.label){case 0:return e=window.roamAlphaAPI.util.generateUID(),[4,window.roamAlphaAPI.q("[:find ?parent-uid ?old-order :in $ ?child-uid :where [?b :block/uid ?child-uid] [?b :block/parents ?p] [?p :block/children ?b] [?p :block/uid ?parent-uid] [?b :block/order ?old-order]]",t)[0]];case 1:return i=n.sent(),o=i[0],r=i[1],[4,window.roamAlphaAPI.data.block.create({location:{"parent-uid":o,order:r},block:{string:"Refactor: ((".concat(t,"))"),uid:e}})];case 2:return n.sent(),[4,window.roamAlphaAPI.data.block.create({location:{"parent-uid":e,order:0},block:{string:"",uid:window.roamAlphaAPI.util.generateUID()}})];case 3:return n.sent(),a=window.roamAlphaAPI.util.generateUID(),[4,window.roamAlphaAPI.data.block.create({location:{"parent-uid":e,order:1},block:{string:"Notes",uid:a,open:!1}})];case 4:return n.sent(),[4,window.roamAlphaAPI.data.block.move({location:{"parent-uid":a,order:0},block:{uid:t}})];case 5:return n.sent(),window.roamAlphaAPI.ui.rightSidebar.addWindow({window:{type:"block","block-uid":a}}),[2]}}))}))}function d(i){var t;return e(this,void 0,void 0,(function(){var e,o,r,a,l,d;return n(this,(function(n){switch(n.label){case 0:if(e=function(){var e,n=null===(e=document.getElementsByClassName("block-highlight-blue"))||void 0===e?void 0:e[0];return n?function(e){var n=[];for(e=e.parentNode.firstElementChild;e;)3!==e.nodeType&&(n.push(e),e=e.nextElementSibling);return n}(n).filter((function(e){return e.classList.contains("rm-block")&&e.classList.contains("block-highlight-blue")})).map((function(e){return(n=e.querySelectorAll("div[id^='block-input-']")[0].id).substring(n.length-9,n.length);var n})):[]}(),!e.length){if(!(o=null===(t=window.roamAlphaAPI.ui.getFocusedBlock())||void 0===t?void 0:t["block-uid"]))return[2];e=[o]}r=0,a=e,n.label=1;case 1:return r<a.length?(l=a[r],[4,window.roamAlphaAPI.q("[:find ?page-uid :in $ ?block-uid :where [?b :block/uid ?block-uid] [?b :block/page ?p] [?p :block/uid ?page-uid]]",l)[0][0]]):[3,5];case 2:return d=n.sent(),[4,i(d,l)];case 3:n.sent(),n.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}function c(i){var t,o;return e(this,void 0,void 0,(function(){var e,r;return n(this,(function(n){switch(n.label){case 0:return(e=null==i?void 0:i["page-uid"])?[4,null===(o=null===(t=window.roamAlphaAPI.q("\n    [:find ?uid :in $ ?block-uid :where [?e :block/uid ?block-uid] [?e :block/children ?c] [?c :block/order 0] [?c :block/uid ?uid]]\n    ",e))||void 0===t?void 0:t[0])||void 0===o?void 0:o[0]]:[3,3];case 1:return(r=n.sent())?[4,window.roamAlphaAPI.ui.setBlockFocusAndSelection({location:{"block-uid":r,"window-id":i["window-id"]}})]:[2];case 2:return n.sent(),[3,5];case 3:return[4,window.roamAlphaAPI.ui.setBlockFocusAndSelection({location:{"block-uid":i["block-uid"],"window-id":i["window-id"]}})];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))}function u(t){return e(this,void 0,void 0,(function(){var e,o,r,a;return n(this,(function(n){switch(n.label){case 0:return[4,i()];case 1:return e=n.sent(),[4,window.roamAlphaAPI.util.generateUID()];case 2:return o=n.sent(),r=window.roamAlphaAPI.q("\n [:find [?c ...] :in $ ?today-uid :where [?e :block/uid ?today-uid] [?e :block/children ?c]]",e).length,[4,window.roamAlphaAPI.data.block.create({location:{"parent-uid":e,order:r},block:{string:"",uid:o}})];case 3:return n.sent(),t?[4,window.roamAlphaAPI.ui.rightSidebar.addWindow({window:{type:"block","block-uid":o,order:0}})]:[3,7];case 4:return n.sent(),[4,window.roamAlphaAPI.ui.rightSidebar.getWindows().filter((function(e){return e["block-uid"]===o}))[0]["window-id"]];case 5:return a=n.sent(),[4,window.roamAlphaAPI.ui.setBlockFocusAndSelection({location:{"block-uid":o,"window-id":a}})];case 6:return n.sent(),[3,10];case 7:return[4,window.roamAlphaAPI.ui.mainWindow.openBlock({block:{uid:o}})];case 8:return n.sent(),[4,window.roamAlphaAPI.ui.setBlockFocusAndSelection({location:{"block-uid":o,"window-id":"main-window"}})];case 9:n.sent(),n.label=10;case 10:return[2]}}))}))}function s(){return window.roamAlphaAPI.ui.rightSidebar.getWindows().sort((function(e,n){return e.order-n.order}))}console.log("Initializing keyboard shortcuts"),function(){var t=this;document.addEventListener("keydown",(function(o){return e(t,void 0,void 0,(function(){var t,r,w,h,p,b,A,k,v,f,m,g,I,P,y,S,B,W,K,E,$,F,q,D,x,T,U;return n(this,(function(N){switch(N.label){case 0:return t=parseInt(o.key),o.ctrlKey&&o.shiftKey&&"Backspace"===o.code?(d(a),[3,40]):[3,1];case 1:return o.ctrlKey&&o.shiftKey&&"KeyX"===o.code?(d(l),[3,40]):[3,2];case 2:return o.altKey&&"KeyB"===o.code?[4,u(o.ctrlKey)]:[3,4];case 3:return N.sent(),[3,40];case 4:return o.ctrlKey&&o.altKey&&"KeyW"===o.code?(o.preventDefault(),[4,null===(E=window.roamAlphaAPI.ui.getFocusedBlock())||void 0===E?void 0:E["block-uid"]]):[3,6];case 5:return function(i){var t,o;e(this,void 0,void 0,(function(){var e,r,a,l,d,c,u,s,w,h,p,b,A;return n(this,(function(n){switch(n.label){case 0:return window.roamAlphaAPI.data.block.update({block:{uid:i,open:!1}}),[4,null===(o=null===(t=window.roamAlphaAPI.q("[:find (pull ?e [:block/string :block/order :block/uid {:block/_refs 2} {:block/children 2}]) :in $ ?uid :where [?e :block/uid ?uid]]",i))||void 0===t?void 0:t[0])||void 0===o?void 0:o[0]];case 1:return e=n.sent(),r=e.string,[4,window.roamAlphaAPI.data.block.update({block:{uid:i,string:"[[".concat(r,"]]")}})];case 2:return n.sent(),[4,window.roamAlphaAPI.q("[:find ?uid :in $ ?block-string :where [?e :node/title ?block-string] [?e :block/uid ?uid]]",r)[0][0]];case 3:if(a=n.sent(),!(null==e?void 0:e.children))return[3,7];l=0,d=null==e?void 0:e.children,n.label=4;case 4:return l<d.length?(c=d[l],u=c.uid,s=c.order,[4,window.roamAlphaAPI.data.block.move({location:{"parent-uid":a,order:s},block:{uid:u}})]):[3,7];case 5:n.sent(),n.label=6;case 6:return l++,[3,4];case 7:if(!(null==(w=e._refs)?void 0:w.length))return[3,11];h=0,p=w,n.label=8;case 8:return h<p.length?(b=p[h],A=b.string.replaceAll("((".concat(e.uid,"))"),"[[".concat(e.string,"]]")),[4,window.roamAlphaAPI.data.block.update({block:{uid:b.uid,string:A}})]):[3,11];case 9:n.sent(),n.label=10;case 10:return h++,[3,8];case 11:return[2]}}))}))}(h=N.sent()),[3,40];case 6:return o.ctrlKey&&o.altKey&&"KeyQ"===o.code?(r="",w=null===($=document.getElementsByClassName("rm-title-editing-display"))||void 0===$?void 0:$[0],[4,null===(F=window.roamAlphaAPI.ui.getFocusedBlock())||void 0===F?void 0:F["block-uid"]]):[3,14];case 7:return h=N.sent(),w?(p=w.firstElementChild.innerHTML)?[4,null===(D=null===(q=window.roamAlphaAPI.q("[:find ?uid :in $ ?page-title :where [?e :node/title ?page-title] [?e :block/uid ?uid]]",p))||void 0===q?void 0:q[0])||void 0===D?void 0:D[0]]:[2]:[3,9];case 8:return r=N.sent(),[3,13];case 9:return h?[4,null===(T=null===(x=window.roamAlphaAPI.q("[:find ?uid :in $ ?block-uid :where [?b :block/uid ?block-uid] [?b :block/page ?p] [?p :block/uid ?uid]]",h))||void 0===x?void 0:x[0])||void 0===T?void 0:T[0]]:[3,11];case 10:return r=N.sent(),[3,13];case 11:return[4,window.roamAlphaAPI.ui.mainWindow.getOpenPageOrBlockUid()];case 12:r=N.sent(),N.label=13;case 13:return b=/^(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])\-\d{4}$/,!r||(null===(U=r.match(b))||void 0===U?void 0:U.length)?[2]:(function(t){var o,r;e(this,void 0,void 0,(function(){var e,a,l,d,c,u,s,w,h,p,b,A,k,v,f,m;return n(this,(function(n){switch(n.label){case 0:return[4,i()];case 1:return e=n.sent(),a=window.roamAlphaAPI.ui.getFocusedBlock(),l=!window.roamAlphaAPI.ui.rightSidebar.getWindows().find((function(e){return e["window-id"]===a["window-id"]})),[4,null===(r=null===(o=window.roamAlphaAPI.q("[:find (pull ?e [:node/title :block/string :block/order :block/uid {:block/_refs 2} {:block/children 2}]) :in $ ?uid :where [?e :block/uid ?uid]]",t))||void 0===o?void 0:o[0])||void 0===r?void 0:r[0]];case 2:return d=n.sent(),c=d.title,u=window.roamAlphaAPI.util.generateUID(),[4,window.roamAlphaAPI.data.block.create({location:{"parent-uid":e,order:-1},block:{uid:u,string:c}})];case 3:if(n.sent(),!(null==d?void 0:d.children))return[3,7];s=0,w=d.children,n.label=4;case 4:return s<w.length?(h=w[s],p=h.uid,b=h.order,[4,window.roamAlphaAPI.data.block.move({location:{"parent-uid":u,order:b},block:{uid:p}})]):[3,7];case 5:n.sent(),n.label=6;case 6:return s++,[3,4];case 7:if(!(null==(A=d._refs)?void 0:A.length))return[3,11];k=0,v=A,n.label=8;case 8:return k<v.length?(f=v[k],m=f.string.replaceAll("[[".concat(d.title,"]]"),"((".concat(u,"))")),[4,window.roamAlphaAPI.data.block.update({block:{uid:f.uid,string:m}})]):[3,11];case 9:n.sent(),n.label=10;case 10:return k++,[3,8];case 11:return[4,window.roamAlphaAPI.data.page.delete({page:{uid:t}})];case 12:return n.sent(),l?(window.roamAlphaAPI.ui.mainWindow.openBlock({block:{uid:u}}),[3,15]):[3,13];case 13:return[4,window.roamAlphaAPI.ui.rightSidebar.addWindow({window:{type:"block","block-uid":u}})];case 14:n.sent(),n.label=15;case 15:return[2]}}))}))}(r),[3,40]);case 14:return o.altKey&&("-"===o.key||t>=0&&t<=9)?1!==t?[3,16]:[4,window.roamAlphaAPI.ui.mainWindow.focusFirstBlock()]:[3,18];case 15:return N.sent(),[2];case 16:return(null==(I=s().reverse())?void 0:I.length)?(A=0,A="-"===o.key?I.length-1:"0"===o.key?8:t-2,(k=I[A])?"graph"===k.type||"mentions"==k.type?[2]:[4,c(k)]:[2]):[2];case 17:return N.sent(),[3,40];case 18:return!o.altKey||"z"!==o.key&&"x"!==o.key?[3,30]:(v=window.roamAlphaAPI.ui.getFocusedBlock())?[3,20]:[4,window.roamAlphaAPI.ui.mainWindow.focusFirstBlock()];case 19:return N.sent(),[2];case 20:return f="z"===o.key,(I=s().reverse()).length?(y=I.find((function(e){return e["window-id"]===v["window-id"]})),m=void 0,y?[3,21]:(m=f?I.at(-1):I[0],[3,28])):[2];case 21:return g=I.indexOf(y),f?0!=g?[3,23]:[4,window.roamAlphaAPI.ui.mainWindow.focusFirstBlock()]:[3,25];case 22:return N.sent(),[2];case 23:m=I[g-1],N.label=24;case 24:return[3,28];case 25:return g!=I.length-1?[3,27]:[4,window.roamAlphaAPI.ui.mainWindow.focusFirstBlock()];case 26:return N.sent(),[2];case 27:m=I[g+1],N.label=28;case 28:return[4,c(m)];case 29:return N.sent(),[3,40];case 30:return o.altKey&&"w"===o.key?(I=s().reverse()).length?[3,32]:[4,window.roamAlphaAPI.ui.mainWindow.openDailyNotes()]:[3,40];case 31:return N.sent(),window.roamAlphaAPI.ui.mainWindow.focusFirstBlock(),[2];case 32:return P=window.roamAlphaAPI.ui.getFocusedBlock(),y=I.find((function(e){return e["window-id"]===(null==P?void 0:P["window-id"])})),P&&y?[3,38]:(S=I[0],(B=null==S?void 0:S["page-uid"])?[4,window.roamAlphaAPI.ui.mainWindow.openPage({page:{uid:B}})]:[3,34]);case 33:return N.sent(),[3,36];case 34:return B=S["block-uid"],[4,window.roamAlphaAPI.ui.mainWindow.openBlock({block:{uid:B}})];case 35:N.sent(),N.label=36;case 36:return[4,window.roamAlphaAPI.ui.rightSidebar.removeWindow({window:{"block-uid":B,type:S.type}})];case 37:return N.sent(),[2];case 38:if(W=void 0,(K=I.indexOf(y)+1)===I.length){if(1===I.length)return window.roamAlphaAPI.ui.rightSidebar.removeWindow({window:{"block-uid":(null==y?void 0:y["page-uid"])||y["block-uid"],type:y.type}}),window.roamAlphaAPI.ui.mainWindow.focusFirstBlock(),[2];W=I.at(-2)}else W=I.at(K);return window.roamAlphaAPI.ui.rightSidebar.removeWindow({window:{"block-uid":(null==y?void 0:y["page-uid"])||y["block-uid"],type:y.type}}),[4,c(W)];case 39:N.sent(),N.label=40;case 40:return[2]}}))}))}))}(),setTimeout((function(){(function(e,n,i){if(i||2===arguments.length)for(var t,o=0,r=n.length;o<r;o++)!t&&o in n||(t||(t=Array.prototype.slice.call(n,0,o)),t[o]=n[o]);return e.concat(t||Array.prototype.slice.call(n))})([],document.querySelectorAll("div#app, div.roam-app"),!0).forEach((function(e){e.addEventListener("keydown",(function(e){if("Tab"===e.code&&!e.shiftKey){var n=document.activeElement;n.selectionEnd+=2;var i=window.getSelection().toString(),t="";if(t=i.match(/^\]\(/)){e.preventDefault(),e.stopImmediatePropagation();var o=n.value.substring(0,n.selectionStart).match(/[^\[]*$/);n.selectionStart+=t[0].length,n.selectionEnd-=i.length-t[0].length,o[0].length>1&&e.ctrlKey&&(o="[["+o[0]+"]]",n.setRangeText(o,n.selectionStart,n.selectionStart,"end"),n.selectionEnd-=2,n.dispatchEvent(new Event("input",{bubbles:!0})))}else(t=i.match(/^\)(?!\))/))||(t=i.match(/^\](?!\])/))||(t=i.match(/^\}(?!\{)/))||(t=i.match(/^\}\{/))||(t=i.match(/^\$\$/))?(e.preventDefault(),e.stopImmediatePropagation(),n.selectionStart+=t[0].length,n.selectionEnd-=i.length-t[0].length):n.selectionEnd-=i.length}}))}))}),1),console.log("Initialized ".concat("shan-personal-scripts"))}();
